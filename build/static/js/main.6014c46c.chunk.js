(this["webpackJsonpcandy-machine-ui"]=this["webpackJsonpcandy-machine-ui"]||[]).push([[0],{168:function(e,t){},172:function(e,t){},198:function(e,t,n){},200:function(e,t){},21:function(e,t,n){"use strict";(function(e){n.d(t,"h",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return m}));var i=n(14),a=n(22),o=n(4);const r=e=>{if(e)return new Date(1e3*e.toNumber())},s=new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),c={format:e=>e?s.format(e):"--",asNumber:e=>{if(e)return e.toNumber()/o.LAMPORTS_PER_SOL}},l=new i.e.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),u=new i.e.PublicKey("gatem74V238djXdzWnJf94Wo1DcnuGkfijbf3AuBhfs"),d="ignREusXmGrscGNUesoU9mxfds9AiYTezUKex2PsZV6",g=async(e,t)=>await i.e.PublicKey.findProgramAddress([t.toBuffer(),a.b.toBuffer(),e.toBuffer()],l),b=async t=>await i.e.PublicKey.findProgramAddress([t.toBuffer(),e.from("expire")],u),m=async(t,n)=>await i.e.PublicKey.findProgramAddress([t.toBuffer(),e.from("gateway"),e.from([0,0,0,0,0,0,0,0]),n.toBuffer()],u)}).call(this,n(5).Buffer)},266:function(e,t,n){},269:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(48),r=n.n(o),s=(n(198),n(14)),c=n(31),l=n(59),u=n(337),d=n(329),g=n(335),b=n(328),m=n(332),h=n(338),f=n(4),y=n(319),p=n(98),w=n(318),v=n(55),j=n(21),S=n(174),O=n(175),k=n(2);const P=Object(O.a)("div")((e=>{let{theme:t}=e;return{display:"flex",padding:t.spacing(0),"& > *":{margin:t.spacing(.4),width:t.spacing(6),height:t.spacing(6),display:"flex",flexDirection:"column",alignContent:"center",alignItems:"center",justifyContent:"center",background:"#384457",color:"white",borderRadius:5,fontSize:10}}})),x=Object(O.a)("span")((e=>{let{theme:t}=e;return{display:"flex",margin:0,marginBottom:t.spacing(.5),height:t.spacing(3.5),padding:t.spacing(1),flexDirection:"column",alignContent:"center",alignItems:"center",justifyContent:"center",background:"#384457",color:"white",borderRadius:5,fontWeight:"bold",fontSize:18}})),T=Object(O.a)("span")({fontWeight:"bold",fontSize:18}),M=e=>{let{date:t,status:n,style:i,onComplete:a}=e;const o=e=>{let{days:t,hours:a,minutes:o,seconds:r,completed:s}=e;return a+=24*t,s?n?Object(k.jsx)(x,{children:n}):null:Object(k.jsxs)(P,{style:i,children:[Object(k.jsxs)(g.a,{elevation:0,children:[Object(k.jsx)(T,{children:a<10?"0".concat(a):a}),Object(k.jsx)("span",{children:"hrs"})]}),Object(k.jsxs)(g.a,{elevation:0,children:[Object(k.jsx)(T,{children:o<10?"0".concat(o):o}),Object(k.jsx)("span",{children:"mins"})]}),Object(k.jsxs)(g.a,{elevation:0,children:[Object(k.jsx)(T,{children:r<10?"0".concat(r):r}),Object(k.jsx)("span",{children:"secs"})]})]})};return t?Object(k.jsx)(S.a,{date:t,onComplete:a,renderer:o}):null};var A,E=n(272),R=n(336),C=n(43),D=n(99),I=n(79);const K=Object(l.default)(E.a)(A||(A=Object(c.a)(["\n  width: 100%;\n  height: 60px;\n  margin-top: 10px;\n  margin-bottom: 5px;\n  background: linear-gradient(180deg, #604ae5 0%, #813eee 100%);\n  color: white;\n  font-size: 16px;\n  font-weight: bold;\n"]))),N=e=>{let{onMint:t,candyMachine:n,isMinting:a,setIsMinting:o,isActive:r}=e;const s=Object(p.b)(),c=Object(D.b)(),[l,u]=Object(i.useState)(!1),{requestGatewayToken:d,gatewayStatus:g}=Object(C.useGateway)(),[b,m]=Object(i.useState)(-1),[h,f]=Object(i.useState)(!1),[y,w]=Object(i.useState)(!1);Object(i.useEffect)((()=>{l&&h&&(async()=>{await Object(I.removeAccountChangeListener)(c.connection,b),await t(),f(!1),u(!1)})()}),[l,h,c.connection,t,b]);const v=function(e){const t=Object(i.useRef)();return Object(i.useEffect)((()=>{t.current=e}),[e]),t.current}(g);return Object(i.useEffect)((()=>{const e=[C.GatewayStatus.NOT_REQUESTED,C.GatewayStatus.REFRESH_TOKEN_REQUIRED],t=[...e,C.GatewayStatus.UNKNOWN];e.find((e=>v===e))&&!t.find((e=>g===e))&&o(!0),console.log("change: ",C.GatewayStatus[g])}),[y,v,g]),Object(i.useEffect)((()=>{y&&g===C.GatewayStatus.ACTIVE&&(console.log("Minting after token active"),w(!1),t())}),[y,g,t]),Object(k.jsx)(K,{disabled:a||!r,onClick:async()=>{if(null!==n&&void 0!==n&&n.state.isActive&&null!==n&&void 0!==n&&n.state.gatekeeper){const e=n.state.gatekeeper.gatekeeperNetwork.toBase58();if(e===j.b)g===C.GatewayStatus.ACTIVE?await t():(w(!0),await d(),console.log("after: ",g));else{if("ttib7tuX8PTWPqFsmUFQTj78MbRhUmqxidJRDv4hRRE"!==e&&"tibePmPaoTgrs929rWpu755EXaxC7M3SthVCf6GzjZt"!==e)throw f(!1),new Error("Unknown Gatekeeper Network: ".concat(e));{f(!0);const i=await Object(I.findGatewayToken)(c.connection,s.publicKey,n.state.gatekeeper.gatekeeperNetwork);if(null!==i&&void 0!==i&&i.isValid())await t();else{window.open("https://verify.encore.fans/?gkNetwork=".concat(e),"_blank");const t=await Object(I.getGatewayTokenAddressForOwnerAndGatekeeperNetwork)(s.publicKey,n.state.gatekeeper.gatekeeperNetwork);m(Object(I.onGatewayTokenChange)(c.connection,t,(()=>u(!0)),"confirmed"))}}}}else await t(),f(!1)},variant:"contained",children:null!==n&&void 0!==n&&n.state.isSoldOut?"SOLD OUT":a?Object(k.jsx)(R.a,{}):null!==n&&void 0!==n&&n.state.isPresale||null!==n&&void 0!==n&&n.state.isWhitelistOnly?"WHITELIST MINT":"MINT"})};var B,W,L=n(29);const _=Object(l.default)(w.a)(B||(B=Object(c.a)(["\n  width: 100%;\n  height: 60px;\n  margin-top: 10px;\n  margin-bottom: 5px;\n  background: linear-gradient(180deg, #604ae5 0%, #813eee 100%);\n  color: white;\n  font-size: 16px;\n  font-weight: bold;\n"]))),U=l.default.div(W||(W=Object(c.a)([""]))),F=e=>{var t;return e.state.isActive&&null!==(t=e.state.endSettings)&&void 0!==t&&t.endSettingType.date?Object(j.h)(e.state.endSettings.number):Object(j.h)(e.state.goLiveDate?e.state.goLiveDate:e.state.isPresale?new s.a((new Date).getTime()/1e3):void 0)};var G,z,Y=e=>{var t,n,a;const[o,r]=Object(i.useState)(!1),[c,l]=Object(i.useState)(),[w,S]=Object(i.useState)({open:!1,message:"",severity:void 0}),[O,P]=Object(i.useState)(!1),[x,T]=Object(i.useState)(),[A,E]=Object(i.useState)(),[R,D]=Object(i.useState)(!1),[I,K]=Object(i.useState)(!1),[B,W]=Object(i.useState)(!1),[G,z]=Object(i.useState)(),[Y,V]=Object(i.useState)(!0),[H,q]=Object(i.useState)(),J=e.rpcHost,Z=Object(y.a)(),{connect:X,connected:Q,publicKey:$,wallet:ee}=Object(p.b)(),te=e.network,ne=Object(i.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"confirmed";if(!$)return;if(void 0!==e.error)return void S({open:!0,message:e.error,severity:"error",hideDuration:null});const n=new f.Connection(e.rpcHost,t);if(e.candyMachineId)try{var i,a,o,r,c;const t=await Object(v.d)(Z,e.candyMachineId,n);console.log("Candy machine state: ",t);let d=!(null===t||void 0===t||!t.state.goLiveDate)&&(null===t||void 0===t?void 0:t.state.goLiveDate.toNumber())<(new Date).getTime()/1e3,g=!1,b=!1,m=t.state.price;if(null!==t&&void 0!==t&&t.state.whitelistMintSettings){t.state.whitelistMintSettings.presale&&(!t.state.goLiveDate||t.state.goLiveDate.toNumber()>(new Date).getTime()/1e3)&&(g=!0),t.state.whitelistMintSettings.discountPrice?(z(t.state.whitelistMintSettings.discountPrice),m=t.state.whitelistMintSettings.discountPrice):(z(void 0),t.state.whitelistMintSettings.presale||(t.state.isWhitelistOnly=!0));const e=new s.e.PublicKey(t.state.whitelistMintSettings.mint),i=(await Object(j.e)(e,$))[0];try{const e=await n.getTokenAccountBalance(i);b=parseInt(e.value.amount)>0,D(b),t.state.isWhitelistOnly&&(d=b&&(g||d))}catch(u){D(!1),t.state.isWhitelistOnly&&(d=!1),console.log("There was a problem fetching whitelist token balance"),console.log(u)}}if(m=b?m:t.state.price,null!==t&&void 0!==t&&t.state.tokenMint){const e=new s.e.PublicKey(t.state.tokenMint),i=(await Object(j.e)(e,$))[0];try{const e=await n.getTokenAccountBalance(i),t=new s.a(e.value.amount).gte(m);W(t),d=d&&t}catch(u){W(!1),d=!1,console.log("There was a problem fetching SPL token balance"),console.log(u)}}else{const e=new s.a(await n.getBalance($)).gte(m);W(e),d=d&&e}if(null!==t&&void 0!==t&&null!==(i=t.state.endSettings)&&void 0!==i&&i.endSettingType.date&&(T(Object(j.h)(t.state.endSettings.number)),t.state.endSettings.number.toNumber()<(new Date).getTime()/1e3&&(d=!1)),null!==t&&void 0!==t&&null!==(a=t.state.endSettings)&&void 0!==a&&a.endSettingType.amount){const e=Math.min(t.state.endSettings.number.toNumber(),t.state.itemsAvailable);t.state.itemsRedeemed<e?E(e-t.state.itemsRedeemed):(E(0),t.state.isSoldOut=!0)}else E(t.state.itemsRemaining);t.state.isSoldOut&&(d=!1);const[h]=await Object(v.e)(e.candyMachineId),f=await n.getAccountInfo(h);P(t.state.isActive=d),K(t.state.isPresale=g),l(t);const y=892+(f&&t.state.retainAuthority?182:0)+(t.state.tokenMint?66:0)+(t.state.whitelistMintSettings?34:0)+(null!==(o=t.state.whitelistMintSettings)&&void 0!==o&&null!==(r=o.mode)&&void 0!==r&&r.burnEveryTime?34:0)+(t.state.gatekeeper?33:0)+(null!==(c=t.state.gatekeeper)&&void 0!==c&&c.expireOnUse?66:0);V(y>1230)}catch(u){u instanceof Error?u.message==="Account does not exist ".concat(e.candyMachineId)?S({open:!0,message:"Couldn't fetch candy machine state from candy machine with address: ".concat(e.candyMachineId,", using rpc: ").concat(e.rpcHost,"! You probably typed the REACT_APP_CANDY_MACHINE_ID value wrong in your .env file, or you are using the wrong RPC!"),severity:"error",hideDuration:null}):u.message.startsWith("failed to get info about account")&&S({open:!0,message:"Couldn't fetch candy machine state with rpc: ".concat(e.rpcHost,"! This probably means you have an issue with the REACT_APP_SOLANA_RPC_HOST value in your .env file, or you are not using a custom RPC!"),severity:"error",hideDuration:null}):S({open:!0,message:"".concat(u),severity:"error",hideDuration:null}),console.log(u)}else S({open:!0,message:"Your REACT_APP_CANDY_MACHINE_ID value in the .env file doesn't look right! Make sure you enter it in as plain base-58 address!",severity:"error",hideDuration:null})}),[Z,e.candyMachineId,e.error,e.rpcHost]),ae=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{if(r(!0),Q&&null!==c&&void 0!==c&&c.program&&$){var i;let a;if(Y&&void 0===H){S({open:!0,message:"Please sign account setup transaction",severity:"info"}),a=await Object(v.c)(c,$);let t={err:!0};if(a.transaction&&(t=await Object(v.b)(a.transaction,e.txTimeout,e.connection,!0)),!t||t.err)return S({open:!0,message:"Mint failed! Please try again!",severity:"error"}),void r(!1);q(a),S({open:!0,message:"Setup transaction succeeded! Please sign minting transaction",severity:"info"})}else S({open:!0,message:"Please sign minting transaction",severity:"info"});const o=await Object(v.f)(c,$,t,n,null!==(i=a)&&void 0!==i?i:H);let s={err:!0},l=null;if(o&&(s=await Object(v.b)(o.mintTxId,e.txTimeout,e.connection,!0),l=await c.program.provider.connection.getAccountInfo(o.metadataKey,"processed"),console.log("Metadata status: ",!!l)),s&&!s.err&&l){const e=A-1;E(e),P(c.state.isActive=e>0),c.state.isSoldOut=0===e,q(void 0),S({open:!0,message:"Congratulations! Mint succeeded!",severity:"success",hideDuration:7e3}),ne("processed")}else s&&!s.err?(S({open:!0,message:"Mint likely failed! Anti-bot SOL 0.01 fee potentially charged! Check the explorer to confirm the mint failed and if so, make sure you are eligible to mint before trying again.",severity:"error",hideDuration:8e3}),ne()):(S({open:!0,message:"Mint failed! Please try again!",severity:"error"}),ne())}}catch(ie){let t=ie.msg||"Minting failed! Please try again!";ie.msg?311===ie.code?(console.log(ie),t="SOLD OUT!",window.location.reload()):312===ie.code&&(t="Minting period hasn't started yet."):ie.message?ie.message.indexOf("0x137")?(console.log(ie),t="SOLD OUT!"):ie.message.indexOf("0x135")&&(t="Insufficient funds to mint. Please fund your wallet."):t="Transaction timeout! Please try again.",S({open:!0,message:t,severity:"error"}),ne()}finally{r(!1)}},oe=()=>{let e=!O||I;e&&(c.state.isWhitelistOnly&&!R&&(e=!1),x&&Date.now()>=x.getTime()&&(e=!1)),I&&c.state.goLiveDate&&c.state.goLiveDate.toNumber()<=(new Date).getTime()/1e3&&K(c.state.isPresale=!1),P(c.state.isActive=e)};return Object(i.useEffect)((()=>{ne()}),[Z,e.candyMachineId,e.connection,ne]),Object(i.useEffect)((()=>{!function e(){setTimeout((()=>{ne(),e()}),2e4)}()}),[ne]),Object(k.jsxs)(u.a,{style:{marginTop:100},children:[Object(k.jsx)(u.a,{maxWidth:"xs",style:{position:"relative"},children:Object(k.jsxs)(g.a,{style:{padding:24,paddingBottom:10,backgroundColor:"#151A1F",borderRadius:6},children:[Q?Object(k.jsxs)(k.Fragment,{children:[c&&Object(k.jsxs)(m.a,{container:!0,direction:"row",justifyContent:"center",wrap:"nowrap",children:[Object(k.jsxs)(m.a,{item:!0,xs:3,children:[Object(k.jsx)(h.a,{variant:"body2",color:"textSecondary",children:"Remaining"}),Object(k.jsx)(h.a,{variant:"h6",color:"textPrimary",style:{fontWeight:"bold"},children:"".concat(A)})]}),Object(k.jsxs)(m.a,{item:!0,xs:4,children:[Object(k.jsx)(h.a,{variant:"body2",color:"textSecondary",children:R&&G?"Discount Price":"Price"}),Object(k.jsx)(h.a,{variant:"h6",color:"textPrimary",style:{fontWeight:"bold"},children:"\u25ce ".concat(R&&G?j.d.asNumber(G):j.d.asNumber(c.state.price))})]}),Object(k.jsx)(m.a,{item:!0,xs:5,children:O&&x&&Date.now()<x.getTime()?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(M,{date:F(c),style:{justifyContent:"flex-end"},status:"COMPLETED",onComplete:oe},"endSettings"),Object(k.jsx)(h.a,{variant:"caption",align:"center",display:"block",style:{fontWeight:"bold"},children:"TO END OF MINT"})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(M,{date:F(c),style:{justifyContent:"flex-end"},status:null!==c&&void 0!==c&&null!==(t=c.state)&&void 0!==t&&t.isSoldOut||x&&Date.now()>x.getTime()?"COMPLETED":I?"PRESALE":"LIVE",onComplete:oe},"goLive"),I&&c.state.goLiveDate&&c.state.goLiveDate.toNumber()>(new Date).getTime()/1e3&&Object(k.jsx)(h.a,{variant:"caption",align:"center",display:"block",style:{fontWeight:"bold"},children:"UNTIL PUBLIC MINT"})]})})]}),Object(k.jsx)(U,{children:null!==c&&void 0!==c&&c.state.isActive&&null!==c&&void 0!==c&&c.state.gatekeeper&&$&&null!==Z&&void 0!==Z&&Z.signTransaction?Object(k.jsx)(C.GatewayProvider,{wallet:{publicKey:$||new f.PublicKey(v.a),signTransaction:Z.signTransaction},gatekeeperNetwork:null===c||void 0===c||null===(n=c.state)||void 0===n||null===(a=n.gatekeeper)||void 0===a?void 0:a.gatekeeperNetwork,clusterUrl:J,cluster:te,options:{autoShowModal:!1},children:Object(k.jsx)(N,{candyMachine:c,isMinting:o,setIsMinting:e=>r(e),onMint:ae,isActive:O||I&&R&&B})}):Object(k.jsx)(N,{candyMachine:c,isMinting:o,setIsMinting:e=>r(e),onMint:ae,isActive:O||I&&R&&B})})]}):Object(k.jsx)(_,{onClick:e=>{(null===ee||void 0===ee?void 0:ee.adapter.name)===L.b&&(X(),e.preventDefault())},children:"Connect Wallet"}),Object(k.jsx)(h.a,{variant:"caption",align:"center",display:"block",style:{marginTop:7,color:"grey"},children:"Powered by METAPLEX"})]})}),Object(k.jsx)(d.a,{open:w.open,autoHideDuration:void 0===w.hideDuration?6e3:w.hideDuration,onClose:()=>S({...w,open:!1}),children:Object(k.jsx)(b.a,{onClose:()=>S({...w,open:!1}),severity:w.severity,children:w.message})})]})},V=n(61),H=n(324),q=n(326),J=n(325),Z=n(184),X=n(334),Q=n(321),$=n(323),ee=n(322),te=n(331);const ne=Object(Z.a)({palette:{mode:"dark"}});let ie;const ae=(()=>{try{return new s.e.PublicKey("ANDCDDwyYXFUPzL4vok41Wfs8vzicm9sQEpCNjVMmzZa")}catch(e){return void console.log("Failed to construct CandyMachineId",e)}})(),oe=null!==(G="devnet")?G:"devnet",re=null!==(z="https://solana-devnet.g.alchemy.com/v2/R3zwAhaFB96B0ARpiVdIqKC4R229Cpxs")?z:s.e.clusterApiUrl("devnet"),se=new s.e.Connection(re);var ce=()=>{const e=Object(i.useMemo)((()=>Object(f.clusterApiUrl)(oe)),[]),t=Object(i.useMemo)((()=>[new Q.a,new ee.a({network:oe}),new $.a,new te.b({network:oe}),new te.a({network:oe})]),[]);return Object(k.jsx)(X.a,{theme:ne,children:Object(k.jsx)(H.a,{endpoint:e,children:Object(k.jsx)(q.a,{wallets:t,autoConnect:!0,children:Object(k.jsx)(J.a,{children:Object(k.jsx)(Y,{candyMachineId:ae,connection:se,txTimeout:V.a,rpcHost:re,network:oe,error:ie})})})})})};var le=e=>{e&&e instanceof Function&&n.e(5).then(n.bind(null,345)).then((t=>{let{getCLS:n,getFID:i,getFCP:a,getLCP:o,getTTFB:r}=t;n(e),i(e),a(e),o(e),r(e)}))};n(266);r.a.render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(ce,{})}),document.getElementById("root")),le()},55:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"f",(function(){return j}));var i=n(14),a=n(22),o=n(4),r=n(61),s=n(21);const c=new i.e.PublicKey("cndy3Z4yapfJBmL3ShUp5exZKqR3z33thTzeNMm2gRZ"),l=new i.e.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),u=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=!1,o={slot:0,confirmations:0,err:null};const r=0;o=await new Promise((async(r,s)=>{for(setTimeout((()=>{a||(a=!0,console.log("Rejecting for timeout..."),s({timeout:!0}))}),t);!a&&i;)(async()=>{try{const t=await n.getSignatureStatuses([e]);o=t&&t.value[0],a||(o?o.err?(console.log("REST error for",e,o),a=!0,s(o.err)):o.confirmations?(console.log("REST confirmation for",e,o),a=!0,r(o)):console.log("REST no confirmations for",e,o):console.log("REST null result for",e,o))}catch(t){a||console.log("REST connection error: txid",e,t)}})(),await S(2e3)}));try{await n.removeSignatureListener(r)}catch(s){}return a=!0,console.log("Returning status",o),o},d=(t,n,o,r)=>{const c=[{pubkey:n,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i.e.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:a.b,isSigner:!1,isWritable:!1},{pubkey:i.e.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new i.e.TransactionInstruction({keys:c,programId:s.c,data:e.from([])})},g=async(e,t,n)=>{const a=new i.c(n,e,{preflightCommitment:"processed"}),[[o,r],s]=await Promise.all([(async()=>{const e=await i.b.fetchIdl(c,a),n=new i.b(e,c,a),o=await n.account.candyMachine.fetch(t);return[n,o]})(),(async()=>{var e;const t=await n.getSlot();return null!==(e=await n.getBlockTime(t))&&void 0!==e?e:(new Date).getTime()/1e3})()]),l=r.data.itemsAvailable.toNumber(),u=r.itemsRedeemed.toNumber(),d=l-u,g=(new Date).getTime()/1e3-s;null!==r.data.goLiveDate&&r.data.goLiveDate;return{id:t,program:o,state:{authority:r.authority,itemsAvailable:l,itemsRedeemed:u,itemsRemaining:d,isSoldOut:0===d,isActive:!1,isPresale:!1,isWhitelistOnly:!1,goLiveDate:r.data.goLiveDate,treasury:r.wallet,tokenMint:r.tokenMint,gatekeeper:r.data.gatekeeper,endSettings:r.data.endSettings,whitelistMintSettings:r.data.whitelistMintSettings,hiddenSettings:r.data.hiddenSettings,price:r.data.price,retainAuthority:r.data.retainAuthority}}},b=async(e,t)=>{try{return await e.account.freezePda.fetch(t)}catch(n){return null}},m=async t=>(await i.e.PublicKey.findProgramAddress([e.from("metadata"),l.toBuffer(),t.toBuffer(),e.from("edition")],l))[0],h=async t=>(await i.e.PublicKey.findProgramAddress([e.from("metadata"),l.toBuffer(),t.toBuffer()],l))[0],f=async t=>await i.e.PublicKey.findProgramAddress([e.from("candy_machine"),t.toBuffer()],c),y=async t=>await i.e.PublicKey.findProgramAddress([e.from("freeze"),t.toBuffer()],c),p=async t=>await i.e.PublicKey.findProgramAddress([e.from("collection"),t.toBuffer()],c),w=async(t,n)=>(await i.e.PublicKey.findProgramAddress([e.from("metadata"),l.toBuffer(),t.toBuffer(),e.from("collection_authority"),n.toBuffer()],l))[0],v=async(e,t)=>{const n=i.e.Keypair.generate(),o=(await Object(s.e)(n.publicKey,t))[0],c=[n],l=[i.e.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:n.publicKey,space:a.a.span,lamports:await e.program.provider.connection.getMinimumBalanceForRentExemption(a.a.span),programId:a.b}),a.c.createInitMintInstruction(a.b,n.publicKey,0,t,t),d(o,t,t,n.publicKey),a.c.createMintToInstruction(a.b,n.publicKey,o,t,[],1)];return{mint:n,userTokenAccount:o,transaction:(await Object(r.c)(e.program.provider.connection,e.program.provider.wallet,[l],[c],r.b.StopOnFailure,"singleGossip",(()=>{}),(()=>!1),void 0,[],[])).txs[0].txid}},j=async function(e,t){var n;let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],g=arguments.length>4?arguments[4]:void 0;const v=null!==(n=null===g||void 0===g?void 0:g.mint)&&void 0!==n?n:i.e.Keypair.generate(),j=(await Object(s.e)(v.publicKey,t))[0],S=e.state.tokenMint?(await Object(s.e)(e.state.tokenMint,t))[0]:t,O=e.id,k=[],P=[],x=[];if(console.log("SetupState: ",g),g||(x.push(v),P.push(i.e.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:v.publicKey,space:a.a.span,lamports:await e.program.provider.connection.getMinimumBalanceForRentExemption(a.a.span),programId:a.b}),a.c.createInitMintInstruction(a.b,v.publicKey,0,t,t),d(j,t,t,v.publicKey),a.c.createMintToInstruction(a.b,v.publicKey,j,t,[],1))),e.state.gatekeeper&&(k.push({pubkey:(await Object(s.g)(t,e.state.gatekeeper.gatekeeperNetwork))[0],isWritable:!0,isSigner:!1}),e.state.gatekeeper.expireOnUse&&(k.push({pubkey:s.a,isWritable:!1,isSigner:!1}),k.push({pubkey:(await Object(s.f)(e.state.gatekeeper.gatekeeperNetwork))[0],isWritable:!1,isSigner:!1}))),e.state.whitelistMintSettings){const n=new i.e.PublicKey(e.state.whitelistMintSettings.mint),a=(await Object(s.e)(n,t))[0];k.push({pubkey:a,isWritable:!0,isSigner:!1}),e.state.whitelistMintSettings.mode.burnEveryTime&&(k.push({pubkey:n,isWritable:!0,isSigner:!1}),k.push({pubkey:t,isWritable:!1,isSigner:!0}))}e.state.tokenMint&&(k.push({pubkey:S,isWritable:!0,isSigner:!1}),k.push({pubkey:t,isWritable:!1,isSigner:!0}));const T=await h(v.publicKey),M=await m(v.publicKey),[A,E]=await f(O),R=(await y(O))[0];console.log(R.toString());const C=await b(e.program,R);if(console.log("Freeze state: "),console.log(C),null!=C&&(k.push({pubkey:R,isWritable:!0,isSigner:!1}),k.push({pubkey:j,isWritable:!1,isSigner:!1}),null!=e.state.tokenMint)){const t=(await Object(s.e)(e.state.tokenMint,R))[0];k.push({pubkey:t,isWritable:!0,isSigner:!1})}console.log(k.map((e=>e.pubkey.toBase58()))),P.push(await e.program.instruction.mintNft(E,{accounts:{candyMachine:O,candyMachineCreator:A,payer:t,wallet:e.state.treasury,mint:v.publicKey,metadata:T,masterEdition:M,mintAuthority:t,updateAuthority:t,tokenMetadataProgram:l,tokenProgram:a.b,systemProgram:o.SystemProgram.programId,rent:i.e.SYSVAR_RENT_PUBKEY,clock:i.e.SYSVAR_CLOCK_PUBKEY,recentBlockhashes:o.SYSVAR_SLOT_HASHES_PUBKEY,instructionSysvarAccount:i.e.SYSVAR_INSTRUCTIONS_PUBKEY},remainingAccounts:k.length>0?k:void 0}));const[D]=await p(O),I=await e.program.provider.connection.getAccountInfo(D);if(I&&e.state.retainAuthority)try{const n=await e.program.account.collectionPda.fetch(D);console.log(n);const a=n.mint,o=await w(a,D);if(console.log(a),a){const n=await h(a),r=await m(a);console.log("Collection PDA: ",D.toBase58()),console.log("Authority: ",e.state.authority.toBase58()),P.push(await e.program.instruction.setCollectionDuringMint({accounts:{candyMachine:O,metadata:T,payer:t,collectionPda:D,tokenMetadataProgram:l,instructions:i.e.SYSVAR_INSTRUCTIONS_PUBKEY,collectionMint:a,collectionMetadata:n,collectionMasterEdition:r,authority:e.state.authority,collectionAuthorityRecord:o}}))}}catch(B){console.error(B)}const K=[P],N=[x];try{const t=(await Object(r.c)(e.program.provider.connection,e.program.provider.wallet,K,N,r.b.StopOnFailure,"singleGossip",(()=>{}),(()=>!1),void 0,c,u)).txs.map((e=>e.txid));return{mintTxId:t[0],metadataKey:T}}catch(W){console.log(W)}return null},S=e=>new Promise((t=>setTimeout(t,e)))}).call(this,n(5).Buffer)},61:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var i=n(4),a=n(10);const o=6e4;let r;!function(e){e[e.Sequential=0]="Sequential",e[e.Parallel=1]="Parallel",e[e.StopOnFailure=2]="StopOnFailure"}(r||(r={}));const s=async function(e,t,n,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.Parallel,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"singleGossip",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:(e,t)=>{},d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:(e,t)=>!1,g=arguments.length>8?arguments[8]:void 0,b=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[],m=arguments.length>10&&void 0!==arguments[10]?arguments[10]:[];if(!t.publicKey)throw new a.h;const h=b;g||(g=(await e.getLatestBlockhash(c)).blockhash);for(let a=0;a<n.length;a++){const e=n[a],r=o[a];if(0===e.length)continue;const s=new i.Transaction;e.forEach((e=>s.add(e))),s.recentBlockhash=g,s.feePayer=t.publicKey,r.length>0&&s.partialSign(...r),h.push(s)}h.push(...m);const f=h.filter((e=>e.signatures.find((e=>e.publicKey.equals(t.publicKey))))),y=h.filter((e=>!e.signatures.find((e=>e.publicKey.equals(t.publicKey)))));let p=await t.signAllTransactions(f);p=y.concat(p);const w=[];console.log("Signed txns length",p.length,"vs handed in length",n.length);for(let i=0;i<p.length;i++){const t=l({connection:e,signedTransaction:p[i]});if(s!==r.Parallel)try{await t.then((e=>{let{txid:t,slot:n}=e;return u(t,i)})),w.push(t)}catch(v){if(console.log("Failed at txn index:",i),console.log("Caught failure:",v),d(p[i],i),s===r.StopOnFailure)return{number:i,txs:await Promise.all(w)}}else w.push(t)}if(s!==r.Parallel){const e=await Promise.all(w);return{number:p.length,txs:e}}return{number:p.length,txs:await Promise.all(w)}},c=()=>(new Date).getTime()/1e3;async function l(e){let{signedTransaction:t,connection:n,timeout:i=o}=e;const a=t.serialize(),r=c();let s=0;const l=await n.sendRawTransaction(a,{skipPreflight:!0});console.log("Started awaiting confirmation for",l);let g=!1;(async()=>{for(;!g&&c()-r<i;)n.sendRawTransaction(a,{skipPreflight:!0}),await d(500)})();try{const e=await u(l,i,n,"recent",!0);if(!e)throw new Error("Timed out awaiting confirmation on transaction");if(e.err)throw console.error(e.err),new Error("Transaction failed: Custom instruction error");s=(null===e||void 0===e?void 0:e.slot)||0}catch(b){if(console.error("Timeout Error caught",b),b.timeout)throw new Error("Timed out awaiting confirmation on transaction");let e=null;try{e=(await async function(e,t,n){t.recentBlockhash=await e._recentBlockhash(e._disableBlockhashCaching);const i=t.serializeMessage(),a=t._serialize(i).toString("base64"),o=[a,{encoding:"base64",commitment:n}],r=await e._rpcRequest("simulateTransaction",o);if(r.error)throw new Error("failed to simulate transaction: "+r.error.message);return r.result}(n,t,"single")).value}catch(m){}if(e&&e.err){if(e.logs)for(let t=e.logs.length-1;t>=0;--t){const n=e.logs[t];if(n.startsWith("Program log: "))throw new Error("Transaction failed: "+n.slice("Program log: ".length))}throw new Error(JSON.stringify(e.err))}}finally{g=!0}return console.log("Latency",l,c()-r),{txid:l,slot:s}}async function u(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"recent",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1,r={slot:0,confirmations:0,err:null},s=0;r=await new Promise((async(c,l)=>{setTimeout((()=>{o||(o=!0,console.log("Rejecting for timeout..."),l({timeout:!0}))}),t);try{s=n.onSignature(e,((e,t)=>{o=!0,r={err:e.err,slot:t.slot,confirmations:0},e.err?(console.log("Rejected via websocket",e.err),l(r)):(console.log("Resolved via websocket",e),c(r))}),i)}catch(u){o=!0,console.error("WS error in setup",e,u)}for(;!o&&a;)(async()=>{try{const t=await n.getSignatureStatuses([e]);r=t&&t.value[0],o||(r?r.err?(console.log("REST error for",e,r),o=!0,l(r.err)):r.confirmations?(console.log("REST confirmation for",e,r),o=!0,c(r)):console.log("REST no confirmations for",e,r):console.log("REST null result for",e,r))}catch(u){o||console.log("REST connection error: txid",e,u)}})(),await d(2e3)}));try{await n.removeSignatureListener(s)}catch(c){}return o=!0,console.log("Returning status",r),r}function d(e){return new Promise((t=>setTimeout(t,e)))}}},[[269,1,2]]]);
//# sourceMappingURL=main.6014c46c.chunk.js.map